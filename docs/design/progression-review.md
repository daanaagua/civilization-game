# 从“生火”起步的科技-建筑-资源推进链路推演与循环依赖检查

path: docs/design/progression-review.md

## 0. 结论先行

- 目前 buildings.md 存在明显的启动期循环依赖：
  - 多数基础生产建筑（农田、伐木场、采石场、工坊）建造成本都包含「工具」；
  - 但“工具”的产出来源是工坊（每工匠+0.02工具/天），而工坊自身也需要工具才能建造；
  - 更严重的是：采石场需要【采石科技 + 25 工具】，而伐木场/农田也各需要 15/10 工具，这导致在没有“初始工具”或“无需工具的前置生产”之前，无法进入任何生产链条，形成硬循环。
- 存在“石料”与“工具”的相互卡死：
  - 工坊建造需要 90 石料 + 30 工具；
  - 采石场需要 75 石料 + 25 工具且前置科技“采石”；
  - 若没有初始“石料”和“工具”的来源（或无需工具的采集手段），两者互相卡住。
- 结论：需要提供一种“自举”路径，使得玩家从 0 工具也能开启最初级资源生产，继而建造工坊产出工具，再逐步升级到需要工具的建筑。

下面给出两套兼容你现有设计风格的修正方案（任选其一或混合）：

### 方案 A（最小改动，移除 T1 建筑中的工具门槛）
- 工坊：建造成本去掉“30 工具”，保留“120 木材 + 90 石料”，以便成为工具产出的首个可达建筑。
- 伐木场、农田、采石场（T1 版本）：建造成本移除“工具”项（或将工具成本降为 0），保持少量木材/石料成本。
  - 示例（建议）：
    - 农田：50 木材 + 30 石料（去掉 10 工具）
    - 伐木场：60 木材 + 45 石料（去掉 15 工具）
    - 采石场：90 木材 + 75 石料（去掉 25 工具；仍需“采石”科技）
- 工具保留在“进阶/升级建筑（T2 版）”与“仓库/功能建筑”作为门槛，以维持中后期的资源吸附与层级感。

优点：无需改动起始资源与科技大纲；风险低，落地快。  
影响：工具需求峰值整体后移，但不改变玩法结构。

### 方案 B（保留现有成本，但提供“初始工具与简陋采集”）
- 起始给予少量“工具”（建议 60）与可用“木材/石料”若干（例如木材 200、石料 150），用于建造最初的 伐木场/农田/工坊。
  - 预算示例：伐木场(15) + 农田(10) + 工坊(30) = 55 工具，预留 5 以免卡死。
- 同时提供“简陋采集点/临时采集”作为非常低效但“无工具”的基础手段：
  - 采集小队（无需建筑，仅分配人口或是一个 0 成本小建筑）
    - 产出：木材 +0.02/人·天，石料 +0.01/人·天（极低）
    - 目的：作为万一算错账或遗失工具时的自救手段，避免软锁。
- 当工坊建成且开始产出工具后，玩家自然过渡到现有 T1 建筑，再向需要工具的 T2/T3 建筑发展。

优点：保留现有建筑成本的“硬度”与资源压力体验。  
影响：需要在初始资源配置与 UI（采集命令/小建筑）上做少量新增。

---

## 1. 当前建筑依赖摘录（来自 buildings.md）

为便于审阅，摘出关键基础建筑的前置与成本：

- 住房（前置科技：生火）：10 木材 → +2 人口上限（可以平稳扩张人口）
- 农田：50 木材 + 30 石料 + 10 工具（产出食物）
- 伐木场：60 木材 + 45 石料 + 15 工具（产出木材）
- 采石场（前置科技：采石）：90 木材 + 75 石料 + 25 工具（产出石料）
- 工坊：120 木材 + 90 石料 + 30 工具（产出工具）
- 多数仓库/功能建筑均要求工具（合理，定位中后期）

高级链条（局部示例）：
- 青铜冶炼 → 铜矿场/铜冶炼厂/铜仓库都需要较多工具（符合进阶节奏）
- 铁冶炼 → 铁矿场/铁冶炼厂/铁仓库门槛更高（同上）
- 防御工事 → 石墙/要塞需要工具与金属（合理）
- 文化/管理建筑 → 工具为必需（合理）

问题症结集中在“最初两个阶段”的自举路径缺失：如何在 0 工具时开始生产，并尽快建起“工坊”。

---

## 2. 自举推进链（两种可行设计）

### 2.1 采用方案 A（去掉 T1 工具门槛）的推进链

1) 起始科技：生火  
   - 可建 住房（10 木）→ 提升人口上限，保障工人分配空间。

2) 起始可建（无工具版 T1）：
   - 伐木场（60 木 + 45 石）
   - 农田（50 木 + 30 石）
   - 注：“石料”来源？
     - a. 初始给予少量石料（例如 120）用于启动首批 T1 建筑；或
     - b. 同步将“采石场 T1”也去掉工具门槛（90 木 + 75 石，无工具），但需前置科技“采石”。则玩家先研究“采石”→建 T1 采石场来获得更多石料。
   - 推荐 b：保持“研究 → 采石 → T1 采石场”这个科技-建筑节奏感。

3) 工坊（去掉 30 工具，仅需 120 木 + 90 石）  
   - 通过前述 T1 建筑获得木/石后即可建造。
   - 建成后：每工匠每天 +0.02 工具 → 工具开始正产出。

4) 进入工具期  
   - 玩家可逐步建造/升级需要工具的仓库/功能/高级生产建筑。
   - 青铜冶炼/铁冶炼等科技开放后，对应矿场/冶炼厂建造门槛（工具 + 金属）就不再是障碍。

整体上：无循环依赖；节奏为“研究采石 → T1 采石场 → 工坊 → 工具期”。

### 2.2 采用方案 B（保留成本 + 初始工具与简陋采集）

1) 起始科技：生火  
   - 同上，先扩展住房保证人口空间。

2) 初始资源配置：  
   - 工具 60、木材 200、石料 150（参考值，可调整）
   - 用于建造：伐木场(15) + 农田(10) + 工坊(30) = 55 工具；剩余 5 作为保险

3) 简陋采集（无工具）：  
   - 允许玩家分配 1-2 个闲置人口进行“原始采集”
     - 木材 +0.02/人·天、石料 +0.01/人·天
   - 若误用完工具，仍可慢慢攒资源来恢复生产，避免软锁。

4) 工坊建成后 → 工具开始产出  
   - 逐步推进到采石场/仓库/功能建筑（它们需要更多工具）。

整体上：保留原成本强度，同时消除硬锁死，且提供“自救”手段。

---

## 3. 与科技树（technology.md）的衔接建议

由于未提供 technology.md 的具体条目，这里给出一个“衔接骨架”，可以据此对号入座地对齐你已有的科技：

- 生火（起点） → 住房
- 采石（基础采矿） → 采石场（建议 T1 采石场不需工具，仅木+石，保持科技门槛）
- 木材处理/石料加工（储存/处理前置） → 对应仓库与处理类建筑
- 储存/储存技术（或分品类存储科技） → 各类仓库
- 青铜冶炼 → 铜矿场/铜冶炼厂/铜仓库
- 铁冶炼 → 铁矿场/铁冶炼厂/铁仓库
- 防御工事/防御战术 → 石墙/要塞
- 图书馆建设/研究点存储 → 图书馆/研究点仓库
- 君主制/社会体制类 → 宫殿（解锁国王角色）
- 特殊资源链（水晶勘探/加工/储存、魔力储备）按现有前置保持在中后期开放

关键：无论科技树如何细化，只需确保“首个能产出工具的建筑（工坊）”在资源上可达，且获取石料的路径在“无工具”时也有办法启动（方案 A 或 B）。

---

## 4. 检查清单（可用于逐项对照修正）

- [ ] 工坊：是否仍要求“工具”作为建造成本？若是，选择 A 方案移除，或选择 B 方案发放初始工具。
- [ ] 伐木场/农田/采石场（T1 版）：是否需要“工具”？建议首版不需要，工具作为 T2/升级要求。
- [ ] 采石科技 → 采石场（T1 无工具）：确保“采石”只是科技门槛，不附加工具硬门槛。
- [ ] 初始资源（若走 B 方案）：是否配置了足以建成工坊+1-2 个基础生产建筑的工具/木材/石料？
- [ ] 是否存在“储存类建筑需要的工具过多，导致在工具产能爬坡之前就被上限卡死”的情况？可考虑把“储存点/储藏室”的 T1 也去工具化，或降到极低工具成本。
- [ ] 高级链条（金属/武器/马匹/布革/研究点）：均在“工具产能已上线”后才有高工具门槛；不影响自举。

---

## 5. 小型数值建议（如采纳方案 A）

- 工坊：120 木 + 90 石（去掉 30 工具）
- 农田：50 木 + 30 石（去掉 10 工具）
- 伐木场：60 木 + 45 石（去掉 15 工具）
- 采石场（前置：采石）：90 木 + 75 石（去掉 25 工具）

这组数值保持了现有“材料压力”，只是移除了“硬锁死”的工具项。

---

## 6. 最终科技达成路径（抽象骨架）

1) 生火（起始）→ 住房（扩上限）  
2) 研“采石” → 建 T1 采石场（无工具版）  
3) 建 T1 伐木场、农田（无工具版）  
4) 建工坊（无工具成本版）→ 工具产出上线  
5) 各类储存与功能建筑（开始需要工具）  
6) 青铜冶炼 → 铜链条开放  
7) 铁冶炼 → 铁链条开放  
8) 防御工事/战术 → 石墙/要塞  
9) 图书馆建设/研究点存储 → 研究效率与上限  
10) 君主制/社会体制 → 宫殿（王权/角色）  
11) 特殊资源（水晶/魔力）  
12) 最终科技（按你的 technology.md 定义衔接）

在此骨架下全程无自指/循环依赖，玩家不会因为“没有工具就无法获得工具”而卡死。

---

## 7. 下一步需要你的确认/补充

- 请提供 technology.md 的具体条目或确认其中与上文“骨架”能一一对齐。  
- 你偏好采取 方案 A（最小改动、T1 去工具）还是 方案 B（发放初始资源 + 简陋采集）？也可以混合：例如工坊去工具 + 采石场去工具，伐木/农田保留极少量工具需求。
- 若同意具体改动方案，我可以据此“批量修改 buildings.md 与相关平衡常量”，并在 UI 中标注“T1/升级版”的区分，避免玩家困惑。

